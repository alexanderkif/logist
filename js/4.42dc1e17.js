(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"8b24":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"flex flex-center q-pb-lg"},[s("div",{staticClass:"row justify-center items-center q-mt-lg"},[s("div",{staticClass:"col col-auto"},[s("a",{staticClass:"text-primary",attrs:{href:"logist.csv"}},[e._v("Скачать пример файла logist.csv")])]),s("div",{staticClass:"col"},[s("q-file",{staticClass:"q-ml-lg",staticStyle:{width:"300px"},attrs:{label:"Загрузить CSV файл",outlined:""},on:{input:e.input},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1)]),s("div",{staticClass:"row full-width justify-center"},[s("q-table",{staticClass:"q-mt-lg",attrs:{title:"Координаты магазинов",data:e.shops,columns:e.shopColumns,"rows-per-page-options":[0],"row-key":"ttId","hide-bottom":""}}),s("q-table",{staticClass:"q-mt-lg q-ml-lg",attrs:{title:"Заказы магазинов по дням недели",data:e.orders,columns:e.ordersColumns,"rows-per-page-options":[0],"row-key":"ttId","hide-bottom":""},scopedSlots:e._u([{key:"body",fn:function(t){return[s("q-tr",{attrs:{props:t}},[s("q-td",{key:"ttId",attrs:{props:t}},[e._v("\n            "+e._s(t.row.ttId)+"\n          ")]),s("q-td",{key:"monP",attrs:{props:t}},[e._v("\n            "+e._s(t.row.mon.p)+"\n          ")]),s("q-td",{key:"monM",attrs:{props:t}},[e._v("\n            "+e._s(t.row.mon.m)+"\n          ")]),s("q-td",{key:"monN",attrs:{props:t}},[e._v("\n            "+e._s(t.row.mon.n)+"\n          ")]),s("q-td",{key:"tueP",attrs:{props:t}},[e._v("\n            "+e._s(t.row.tue.p)+"\n          ")]),s("q-td",{key:"tueM",attrs:{props:t}},[e._v("\n            "+e._s(t.row.tue.m)+"\n          ")]),s("q-td",{key:"tueN",attrs:{props:t}},[e._v("\n            "+e._s(t.row.tue.n)+"\n          ")]),s("q-td",{key:"wedP",attrs:{props:t}},[e._v("\n            "+e._s(t.row.wed.p)+"\n          ")]),s("q-td",{key:"wedM",attrs:{props:t}},[e._v("\n            "+e._s(t.row.wed.m)+"\n          ")]),s("q-td",{key:"wedN",attrs:{props:t}},[e._v("\n            "+e._s(t.row.wed.n)+"\n          ")]),s("q-td",{key:"thuP",attrs:{props:t}},[e._v("\n            "+e._s(t.row.thu.p)+"\n          ")]),s("q-td",{key:"thuM",attrs:{props:t}},[e._v("\n            "+e._s(t.row.thu.m)+"\n          ")]),s("q-td",{key:"thuN",attrs:{props:t}},[e._v("\n            "+e._s(t.row.thu.n)+"\n          ")]),s("q-td",{key:"friP",attrs:{props:t}},[e._v("\n            "+e._s(t.row.fri.p)+"\n          ")]),s("q-td",{key:"friM",attrs:{props:t}},[e._v("\n            "+e._s(t.row.fri.m)+"\n          ")]),s("q-td",{key:"friN",attrs:{props:t}},[e._v("\n            "+e._s(t.row.fri.n)+"\n          ")])],1)]}}])})],1),s("PrintWaysByDays",{attrs:{week:e.week}})],1)},a=[],l=(s("e6cf"),s("ddb0"),s("13d5"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._l(e.week,(function(t){return s("div",{key:t.day,staticClass:"row justify-center q-pt-xl"},[s("div",{staticClass:"text-h5 text-bold"},[e._v(e._s(t.day.toUpperCase()))]),s("div",{staticClass:"flex justify-center"},e._l(t.cars,(function(e){return s("div",{key:e.way,staticClass:"q-ml-md"},[s("Way",{attrs:{car:e}})],1)})),0)])})),0)}),n=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-card",{staticClass:"row q-mt-lg"},[s("q-card-section",[s("q-table",{attrs:{title:"Маршрут № "+e.car.way,data:e.car.orders,columns:e.orderColumns,"rows-per-page-options":[0],"row-key":"ttId","hide-bottom":"",dense:"",flat:"",bordered:""}})],1),s("q-card-section",[s("div",{staticClass:"row text-bold"},[e._v("\n      Результаты расчета по маршруту\n    ")]),s("div",{staticClass:"row"},[e._v("\n      Количество перевезенного груза"),s("br"),e._v("\n      "+e._s("P = "+e.getCarBoxes(e.car))+"\n    ")])])],1)},d=[],i={name:"Way",props:{car:Object},data(){return{orderColumns:[{name:"ttId",align:"center",label:"Магазин",field:"ttId",classes:"bg-purple-2",headerClasses:"bg-purple-2 text-bold"},{name:"p",label:"П",field:"p"},{name:"m",label:"М",field:"m"},{name:"n",label:"Н",field:"n"}]}},methods:{getCarBoxes(e){return e.orders.length?e.orders.map((e=>(e.p?e.p:0)+(e.n?e.n:0)+(e.m?e.m:0))).reduce(((e,t)=>e+t)):0}}},p=i,m=s("2877"),u=s("f09f"),c=s("a370"),h=s("eaac"),w=s("eebe"),f=s.n(w),y=Object(m["a"])(p,o,d,!1,null,null,null),b=y.exports;f()(y,"components",{QCard:u["a"],QCardSection:c["a"],QTable:h["a"]});var g={name:"PrintWaysByDays",components:{Way:b},props:{week:Array},data(){return{}}},C=g,_=Object(m["a"])(C,l,n,!1,null,null,null),v=_.exports,x={name:"PageIndex",components:{PrintWaysByDays:v},data(){return{file:null,textFile:null,shops:[],orders:[],week:[],TT:30,shopColumns:[{name:"ttId",align:"center",label:"Магазин",field:"ttId",sortable:!0,classes:"bg-purple-2",headerClasses:"bg-purple-2"},{name:"x",label:"X",field:"x"},{name:"y",label:"Y",field:"y"}],ordersColumns:[{name:"ttId",align:"center",label:"Магазин",field:"ttId",sortable:!0,classes:"bg-purple-2",headerClasses:"bg-purple-2"},{name:"monP",label:"пн П",field:"monP"},{name:"monM",label:"пн М",field:"monM"},{name:"monN",label:"пн Н",field:"monN"},{name:"tueP",label:"вт П",field:"tueP",classes:"bg-grey-2",headerClasses:"bg-grey-2"},{name:"tueM",label:"вт М",field:"tueM",classes:"bg-grey-2",headerClasses:"bg-grey-2"},{name:"tueN",label:"вт Н",field:"tueN",classes:"bg-grey-2",headerClasses:"bg-grey-2"},{name:"wedP",label:"ср П",field:"wedP"},{name:"wedM",label:"ср М",field:"wedM"},{name:"wedN",label:"ср Н",field:"wedN"},{name:"thuP",label:"чт П",field:"thuP",classes:"bg-grey-2",headerClasses:"bg-grey-2"},{name:"thuM",label:"чт М",field:"thuM",classes:"bg-grey-2",headerClasses:"bg-grey-2"},{name:"thuN",label:"чт Н",field:"thuN",classes:"bg-grey-2",headerClasses:"bg-grey-2"},{name:"friP",label:"пт П",field:"friP"},{name:"friM",label:"пт М",field:"friM"},{name:"friN",label:"пт Н",field:"friN"}]}},methods:{async input(){const e=new FileReader;e.readAsText(this.file),this.textFile=await new Promise(((t,s)=>{e.onload=s=>t(e.result)})),await this.setShops(),await this.setOrders();for(let t of["mon","tue","wed","thu","fri"])this.week.push({day:t,cars:await this.loadCarsByDays(t)});console.log("this.week",this.week)},async loadCarsByDays(e){let t=await this.getDayOrders(e);console.log(`===== Cars for ${e.toUpperCase()} =====`);let s=[],r=1,a=!0,l=!0,n=null;while(a)n=await this.loadCarP(t,r),this.getCarBoxes(n)>0&&(s.push(n),r++),this.getCarBoxes(n)<120&&(a=!1);while(l)n=await this.loadCarM(t,r),this.getCarBoxes(n)>0&&(s.push(n),r++),this.getCountBoxes(t)<1&&(l=!1);return console.log("cars",s),console.log("dayOrders",t),s},loadCarM(e,t){let s=0,r={way:t,orders:[]},a=0;for(let l=0;l<e.length;l++)if(+e[l].m+ +e[l].n>0&&s+ +e[l].m+ +e[l].n<=120&&(l-a<9||0===a)){let t={ttId:l+1};+e[l].m>0&&(t.m=+e[l].m),+e[l].n>0&&(t.n=+e[l].n),r.orders.push(t),s+=+e[l].m+ +e[l].n,e[l].m=0,e[l].n=0,a=l}return this.getCarBoxes(r)>0&&console.log(`Car M way = ${r.way} loaded ${this.getCarBoxes(r)} boxes`),r},loadCarP(e,t){let s=0,r=0,a=0;while(s<this.TT&&0===+e[s].p)s++;let l={way:t,orders:[]};while(s+r<this.TT&&a+ +e[s+r].p<120)+e[s+r].p>0&&(l.orders.push({ttId:s+r,p:+e[s+r].p}),a+=+e[s+r].p,e[s+r].p=0),r++;r=0;while(s+r<this.TT&&a+ +e[s+r].n<120)l.orders[r].p>0&&(l.orders[r].n=+e[s+r].n,a+=+e[s+r].n,e[s+r].n=0),r++;return s+r<this.TT&&(l.orders[r].n=120-a,e[s+r].n-=120-a),this.getCarBoxes(l)>0&&console.log(`Car P way = ${l.way} loaded ${this.getCarBoxes(l)} boxes`),l},getCarBoxes(e){return e.orders.length?e.orders.map((e=>(e.p?e.p:0)+(e.n?e.n:0)+(e.m?e.m:0))).reduce(((e,t)=>e+t)):0},getCountBoxes(e){return e.length?e.map((e=>(e.p?e.p:0)+(e.n?e.n:0)+(e.m?e.m:0))).reduce(((e,t)=>e+t)):0},setShops(){this.shops=this.textFile.split("\r\n").slice(2,33).map((e=>e.split(";").slice(0,3))).map((e=>({ttId:e[0],x:e[1],y:e[2]})))},setOrders(){this.orders=this.textFile.split("\r\n").slice(2,32).map((e=>[e.split(";")[0],...e.split(";").slice(3,18)])).map((e=>({ttId:e[0],mon:{p:e[1],m:e[2],n:e[3]},tue:{p:e[4],m:e[5],n:e[6]},wed:{p:e[7],m:e[8],n:e[9]},thu:{p:e[10],m:e[11],n:e[12]},fri:{p:e[13],m:e[12],n:e[13]}})))},getDayOrders(e){switch(e){case"mon":return this.orders.map((e=>({ttId:e.ttId,p:e.mon.p,m:e.mon.m,n:e.mon.n})));case"tue":return this.orders.map((e=>({ttId:e.ttId,p:e.tue.p,m:e.tue.m,n:e.tue.n})));case"wed":return this.orders.map((e=>({ttId:e.ttId,p:e.wed.p,m:e.wed.m,n:e.wed.n})));case"thu":return this.orders.map((e=>({ttId:e.ttId,p:e.thu.p,m:e.thu.m,n:e.thu.n})));case"fri":return this.orders.map((e=>({ttId:e.ttId,p:e.fri.p,m:e.fri.m,n:e.fri.n})));default:return{}}}}},q=x,k=s("9989"),I=s("7d53"),P=s("bd08"),M=s("db86"),B=Object(m["a"])(q,r,a,!1,null,null,null);t["default"]=B.exports;f()(B,"components",{QPage:k["a"],QFile:I["a"],QTable:h["a"],QTr:P["a"],QTd:M["a"]})}}]);